<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Dataset Annotator</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <h1 id="main-title" class="main-title">
      <i class="bi bi-robot"></i> AI Dataset Annotation Tool
    </h1>

    <nav aria-label="breadcrumb">
      <ul>
        <li><a href="upload.html"><i class="bi bi-cloud-upload"></i> Upload Image</a></li>
        <li><a href="labels.html"><i class="bi bi-tags"></i> Manage Labels</a></li>
        <li><a href="images.html"><i class="bi bi-image"></i> View Images</a></li>
      </ul>
    </nav>
    <br>
    <nav aria-label="breadcrumb">
      <ul>
        <li><a href="#labeled-images"><i class="bi bi-images"></i> Labeled Images</a></li>
        <li><a href="#purpose"><i class="bi bi-bullseye"></i> Purpose</a></li>
        <li><a href="#audience"><i class="bi bi-people"></i> Audience</a></li>
        <li><a href="#workflow"><i class="bi bi-diagram-3"></i> Workflow</a></li>
        <li><a href="#features"><i class="bi bi-star"></i> Features</a></li>
        <li><a href="#technical-requirements"><i class="bi bi-gear"></i> Technical</a></li>
        <li><a href="#faq"><i class="bi bi-question-circle"></i> FAQ</a></li>
      </ul>
    </nav>

    <!-- Labeled Images Section -->
    <section class="images-section" id="labeled-images">
      <h2><i class="bi bi-collection"></i> Labeled Images</h2>
      <div id="status" class="status-message"></div>
      
      <!-- Grid Layout for Images (3 columns) -->
      <div id="imagesGrid" class="images-grid-container"></div>
    </section>

    <div class="card mb-3 card-gradient-blue" id="purpose">
      <div class="card-body">
        <h2><i class="bi bi-bullseye"></i> Purpose</h2>
        <p>Simplify the creation of high-quality labeled datasets so teams can focus on model experimentation instead of
          tedious manual tooling. The tool offers a streamlined interface for intuitive dataset management.</p>
      </div>
    </div>

    <div class="card mb-3 card-gradient-purple" id="audience">
      <div class="card-body">
        <h2><i class="bi bi-people-fill"></i> Target Audience</h2>
        <p>Machine learning engineers, data scientists, and researchers who need to create labeled datasets for computer vision tasks.</p>
      </div>
    </div>

    <div class="card mb-3" id="workflow">
      <div class="card-body">
        <h2><i class="bi bi-diagram-3"></i> Workflow</h2>
        <ol>
          <li>Upload images to the system</li>
          <li>Create and manage labels</li>
          <li>Annotate images with appropriate labels</li>
          <li>Export labeled dataset for training</li>
        </ol>
      </div>
    </div>

    <div class="card mb-3" id="features">
      <div class="card-body">
        <h2><i class="bi bi-star-fill"></i> Key Features</h2>
        <ul>
          <li>Easy image upload and management</li>
          <li>Flexible label creation and editing</li>
          <li>Multi-label annotation support</li>
          <li>Intuitive user interface</li>
          <li>Fast and efficient workflow</li>
        </ul>
      </div>
    </div>

    <div class="card mb-3" id="technical-requirements">
      <div class="card-body">
        <h2><i class="bi bi-gear-fill"></i> Technical Requirements</h2>
        <ul>
          <li>Modern web browser (Chrome, Firefox, Safari, Edge)</li>
          <li>JavaScript enabled</li>
          <li>Stable internet connection</li>
        </ul>
      </div>
    </div>

    <div class="card mb-3" id="faq">
      <div class="card-body">
        <h2><i class="bi bi-question-circle-fill"></i> FAQ</h2>
        <details>
          <summary>What image formats are supported?</summary>
          <p>We support JPEG, PNG, and GIF formats.</p>
        </details>
        <details>
          <summary>Can I edit labels after creation?</summary>
          <p>Yes, you can edit or delete labels at any time.</p>
        </details>
        <details>
          <summary>Is there a limit on image size?</summary>
          <p>Images should be under 10MB for optimal performance.</p>
        </details>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  

  <script>
    const imagesGrid = document.getElementById('imagesGrid');
    const statusEl = document.getElementById('status');


    document.addEventListener('DOMContentLoaded', () => {
      console.log('Page loaded, loading labeled images...');
      loadLabeledImages();
    });

    // Load all labeled images
    async function loadLabeledImages() {
      console.log(' Loading labeled images...');
      imagesGrid.innerHTML = '';
      statusEl.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Loading images...';
      statusEl.className = 'status-message';

      try {
        const response = await fetch('/api/images');
        if (!response.ok) throw new Error('Failed to load images');

        const data = await response.json();
        statusEl.innerHTML = '';

        if (!data.images || data.images.length === 0) {
          statusEl.innerHTML = '<div class="alert-info"><i class="bi bi-info-circle"></i> No labeled images yet. Start by uploading some images!</div>';
          return;
        }

        statusEl.innerHTML = `<div class="label-count-badge">Total ${data.images.length} images</div>`;
        console.log('Images loaded:', data.images.length);


        for (const img of data.images) {
          const card = createImageCard(img);
          imagesGrid.appendChild(card);
        }
      } catch (error) {
        console.error('Load images error:', error);
        statusEl.innerHTML = '<div class="alert-danger"><i class="bi bi-exclamation-triangle"></i> Failed to load images. Please check if the server is running.</div>';
        statusEl.className = 'status-message error';
      }
    }

    // Create image card element
    function createImageCard(img) {
      const card = document.createElement('div');
      card.className = 'image-grid-card';
      
      const thumbnailUrl = `/uploads/${img.filename}`;
      
      card.innerHTML = `
        <div class="image-grid-card-inner">
          <div class="image-grid-thumbnail">
            <img src="${thumbnailUrl}" 
                 alt="${escapeHtml(img.filename)}" 
                 onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22%3E%3Crect fill=%22%23e5e7eb%22 width=%22100%22 height=%22100%22/%3E%3Ctext fill=%22%239ca3af%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2214%22%3ENo Image%3C/text%3E%3C/svg%3E'">
          </div>
          <div class="image-grid-info">
            <div class="image-grid-title">${escapeHtml(img.filename)}</div>
            <div class="image-grid-meta">
              <span class="meta-badge">
                <i class="bi bi-tags"></i> ${img.labels_count || 0} label(s)
              </span>
            </div>
            <div class="image-grid-actions">
              <a href="image.html?id=${img.id}" class="btn btn-sm btn-gradient-primary w-100">
                <i class="bi bi-eye"></i> View Details
              </a>
            </div>
          </div>
        </div>
      `;
      
      return card;
    }


    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  </script>
</body>
</html>